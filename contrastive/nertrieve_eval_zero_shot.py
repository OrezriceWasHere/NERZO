import clearml_helper
import clearml_poc
import dataset_provider
import queries
from clearml_pipelines.fewnerd_pipeline import fewnerd_dataset
from clearml_pipelines.nertreieve_dataset import nertrieve_processor
from contrastive import fewnerd_processor
from contrastive.args import FineTuneLLM
from contrastive.retrieval_eval import RetrievalEval


class NERtrieveEvalZeroShot(RetrievalEval):

	def __init__(self, layer, entity_to_embedding):
		super(NERtrieveEvalZeroShot, self).__init__(
			index='nertrieve_test',
			layer=layer,
			entity_to_embedding=entity_to_embedding
		)

	def entity_type_field_name(self):
		return 'entity_type'

	def get_embedding_field_name(self):
		return 'embedding.llama_3_17_v_proj.end'

	def anchors(self):
		return {
			'Animal': ['nert_75948363cc6def46d60690c003a74113466b627e', 'nert_92b7ab0278b3f299ee7c26e080d4eb0dc4da2545',
			           'nert_d824a472256030ce886548d6017666dacb133070'],
			'Sports team': ['nert_62a1157e27480ed2c4437557cd869db2d62a4eaa',
			                'nert_ce31eecbb942aa75d6056a5bfc08365beac00ace',
			                'nert_9d3895ba8d05303203145d33d350befc3ca6066a'],
			'Head of state': ['nert_7c55428b8dab9ecab85271b9eb588db337f0a5e2',
			                  'nert_fde54d83629e12dd8cc64a73ef93332cdee8cf1b',
			                  'nert_77630121e9507f625f1d8cab6312f5e6e077f1eb'],
			'Olympic competitor': ['nert_d1f7da15fa5b84b0f24101509672d65a9992dedd',
			                       'nert_f77354e2d7543230b9080ce3923900a26c13090b',
			                       'nert_e2636ea83b756f0e89cf4cb711a9c1f8cd93d1fd'],
			'Route of transportation': ['nert_218ae7ef7947b22246dcfdba2ba692a5713da21e',
			                            'nert_c053ab03d2391bb9c6e1796a52e78f1b5fea70ce',
			                            'nert_3423b5f69eb4e785476a5c40e4146bf149cae58a'],
			'Rock music group': ['nert_8e21080a2b23add0902aa4a3855a1cabe8200b07',
			                     'nert_b704106d477268acc9f9333a398d96b0a4a9d2d4',
			                     'nert_46050d7e6d659c434eccbc42ec2f79507a9da1fa'],
			'Pop musician': ['nert_09afba1e83c31d329aa69c0538bbf4eab8ca2367',
			                 'nert_89179d8aa3a8e5d55cdf18f3be519492d5f63a8b',
			                 'nert_7e77cec8733225ef9f108642438a34c45ac04d59'],
			'Mountain': ['nert_8ad57960b4a741420abeb2b838caa17e99963a30',
			             'nert_0a4c94f2b49d4ce8dedee57f0b07b4cfa2063274',
			             'nert_fe20290732ab44118a684d19764fb9026a9f0193'],
			'River': ['nert_08d852e7d2025d5f016c231344157883bb7635d5', 'nert_f976842e7201ef1f0a4cf33fc51a1bd814882c40',
			          'nert_61ec1bf7e7f4b23301a4795160f5fe9c2fac9e47'],
			'Stage actor': ['nert_4201d9a9614efa3d378a5d89eefcfcd37420bb8c',
			                'nert_4257f15402a5a2d7dc3832e7676f666040769877',
			                'nert_bf31d39b7b6e0d214d15900847578a19e7a91496'],
			'Celestial body': ['nert_32b992db9db480ef74dd67f2faf05777eb6572fd',
			                   'nert_71e69359afa2f5f4a9139cbc6f36ff1ad1d8182c',
			                   'nert_d812c26f355652a6e7174c2d845cf30044b0d020'],
			'Island': ['nert_53bbfb755f224f2142b50eab5b302081eb04d25c', 'nert_15549c3f2f4d69c219084f6a22cc4826552c4a7e',
			           'nert_36f7a9e958784b811bd787c723937665fabdc7d9'],
			'HumanGene': ['nert_b00e72a4881a3a8d375657ba9aeeeca477bbac0e',
			              'nert_a10778a9c369f750b9cd6cd64e14911aef895348',
			              'nert_c04c907d12eec2b7c4e69e38d1cb8afc31d7c61a'],
			'Bird': ['nert_4f5f128032008ccfce0145d1d0d0839f21d6141e', 'nert_066367452a600758f721c43f01b5b07436cdd222',
			         'nert_4c39071266fd385382dd26930ff2531bf529c66f'],
			'Classical musician': ['nert_94bfced917ecc53b1ad18a82a4f8fbead9305788',
			                       'nert_7d589cf6af6413e87ae095407b589a8d0f9f0a62',
			                       'nert_d98ca09ce4f0d093b9162ca5f9bec53eb2745966'],
			'Saint': ['nert_5c7744fd7688e32c3139f5310f82f0312fd9bb5e', 'nert_46feef7f6eb2de627d15a54a06aeba3ac5d1fbd3',
			          'nert_950542fac1a2ceccf8f466e912f648636af2caff'],
			'Animal genetic': ['nert_c84f25e3fe8ecd4e94a12436ebe3cc44abcdbe63',
			                   'nert_9c372647808e420aeb78ccbcfb23ff1d46aba489',
			                   'nert_46871bfd7eac296f89f0853b8dd17e9101a31912'],
			'Screenwriter': ['nert_3d4e7a25054f7eb817dbac7270b9bf912cea0f8d',
			                 'nert_ce28532a33195777886cf8a244b9cbc20c1725e5',
			                 'nert_d72ce4dde5a96101246bec4485d487b1bfad0fd3'],
			'Artificial material': ['nert_f4241c9b596ee90d9b627d23497d3e8dfa70d5b0',
			                        'nert_493ec9a6478cd7b15aaf6752a70f39b6155721e0',
			                        'nert_03d011baf6ffcbe01bf937943f500a04c4d68374'],
			'Protected area of North America': ['nert_c920fb38e62ae30e4051047a2be337bac11aaa0b',
			                                    'nert_8887d4102921df0e2f5d0626627493e6761bd3bf',
			                                    'nert_c087ae1dff82249a2ca42be1062214e7742a1790'],
			'Pianist': ['nert_0815aea162eba4dbb0d00b506c3f288fc787f706',
			            'nert_dbfa138417f87980672970d014e35eb81c76bd72',
			            'nert_74977fa298fabf6accdbcd06a630d3889bb4cafc'],
			'Science fiction film': ['nert_a5ea7813d7b77e4b3ed5b806b6b6ac859aa1285e',
			                         'nert_54a4abd4cfc3e2bcf056d2994dce931810a4497c',
			                         'nert_1dbf718a188480a002ecbe5b7809041772c9f75b'],
			'Head of state in Europe': ['nert_9731e74bd69ef74918914b964bd8cb68439f2361',
			                            'nert_1a1848ea28f0b776bd94ff1b7bb125e7cbb78faa',
			                            'nert_97354f965f5fddd537bb579c535c47b504aaf0fc'],
			'Mythological character': ['nert_6768b1b6e8daa8e074082078a53b21210eff5fde',
			                           'nert_326b0fca9df7a846017b9d65b999cd92dc4031b5',
			                           'nert_c0291658a5cfd45c450c0d1099d940cb4046fa11'],
			'Receptor agonist': ['nert_4ed34e30717be5393a611be3e2693cf7e4b5d203',
			                     'nert_e0e9e5c927e75dc04a879276d56b1c1e6080d64d',
			                     'nert_3f06a3722cf9cbd9a34e21c91b35fdec7bb98f60'],
			'Boxer': ['nert_a4331a85538724cae5efb714ceee19810e0d1f07', 'nert_54f6ab78c5c41b977d7bd04a0109c55e74c7e6e6',
			          'nert_651f611ca3388d9c885388cebb2dd4765bab0e9e'],
			'Temple': ['nert_6317fb0a6d64425aaf0d77ca9035d26510636774', 'nert_556d4c935a9d98cd5a091e0f4b549404a8272466',
			           'nert_6a184fe5baeed0171de75264daeba20f23a930cb'],
			'Soccer manager': ['nert_abcf4bdc023e32c3f5c04a9f032eaf3d6a1d6ccf',
			                   'nert_c082673f4bc9acf9bff7587f79842d344d0f431b',
			                   'nert_316ed11066089a316da1727bd86602b3f7eadf9f'],
			'Ice hockey team in North America': ['nert_3cef43ce1cd75841f22909997ba4a5f834a2df3f',
			                                     'nert_5813d3ebd00e6ce518a656b610b8464143f91799',
			                                     'nert_e4e5c56e31e6c0823757b95a98b18987dcd49e37'],
			'Indian writer': ['nert_87aca0b6b0e81a0f1eed7f7a27eb5b3690c30ed8',
			                  'nert_4cf2f1be9a35b9dcd7b7071cd058afab758610ce',
			                  'nert_e964a393ce1c14fbdfd2b5b90849dfdd084ae6f8'],
			'Bird of the Atlantic Ocean': ['nert_8d70a858969b3ff90e1da7fab35197ba2bf99e83',
			                               'nert_da474e278c809ae86541ec8cbd4583a9acaefb27',
			                               'nert_5e4e4921fe332ed7b283efaa4fb88d4d53c12408'],
			'Baseball coach': ['nert_4f3cbf9e6e2ef2925fbbc46f858d8e43b8359f4a',
			                   'nert_830d888e42d7f34489f7ef22abdad9f0f0ce91a8',
			                   'nert_84ddc83b7d51629e3fc8c9f436496e0aec54f035'],
			'Linguist': ['nert_222815c9f0a03bf85fc1c20319400094a453f8b1',
			             'nert_7596b5b4d70cbfbe58980cdd8cc9b44e9c3b0660',
			             'nert_06c4a249d389f13cab435d9a4012aa757961c6b5'],
			'Snack food': ['nert_87d86c4915fe7d0c7fad2c7b0761cdbdf8b84e56',
			               'nert_7630fc5b9d1376726f3c391a3ed915c1c499e20b',
			               'nert_c883fcdcb6b7cafca72f40811295b844011d5f4a'],
			'Judoka': ['nert_4b5624fdb40f037a39bad398b4c73649c3070216', 'nert_b80d36e3334fe7d551d438adfe8f5d9cdb9acb86',
			           'nert_ada5dcdab7aa37c8193c534fe1dde4e4dceb740a'],
			'British film': ['nert_c90cb208efd44239a43e23a0c4a2d3f505ef24fe',
			                 'nert_fafca629d778fb29c40ad111b4add3e34b8de6a8',
			                 'nert_dd0a18d10f8298688cb48bcd1d6d0b1a64921b95'],
			'Cyclist': ['nert_5df2d99a1ce2c87b156471d2ee129880a37ad37d',
			            'nert_9d94ae08fc31aa2085170df4768da8b54553681b',
			            'nert_cfb7ec70a78a8ace5149be58ced44bfbcc03e83a'],
			'Basin': ['nert_bb29e3fa6cdbdbf813360795805c3c50e37f0932', 'nert_be74e2730fb5c1005ebb5b4f98621cbc94a3c668',
			          'nert_ed10cdbf5d77dd087cddc1685e4d40259ddbacbb'],
			'Jewish organization': ['nert_c56a83c9b88e9874e7d04a010337c804d2d40320',
			                        'nert_2c90855b6280079ae17f3ca71deb86f3fbf59b19',
			                        'nert_0224a784faf45e7bcf810f99208a17655b563f6b'],
			'Middle Eastern king': ['nert_b02aa6107da25e6004ad3fb7bf3ddae6a780e0ed',
			                        'nert_fab3adaa954bf5e83da07585cf75b6d4caad75c2',
			                        'nert_e5a9531a7f380ef2f63fd512c8049663edf279b9'],
			'Botanist': ['nert_352f9cb2bd954cec6f0eed848bbb62807be18ae8',
			             'nert_700773a6389cfdaf449c03cea7d609fb3b8e0ff8',
			             'nert_bc88b239180bb0bc3a0477f58b0fe6578d7c8a6d'],
			'Mosque': ['nert_a3b9b97d6a59d5b1aec11c1676f67dc4d6c3eee2', 'nert_10d97402ccdf8bb0c8f06cc2b28afc533c45e784',
			           'nert_bdba091fdae41107ad0b0861096cc4465c86f42e'],
			'Person charged with murder': ['nert_8867c089ad905461846b226201b8960d3c157de9',
			                               'nert_b1f953be482d26a6187c1be77c9ec15d72edb3af',
			                               'nert_21cc212c37df14ba73a7e2cc3565dc91d0327d47'],
			'Lighthouse': ['nert_a6d4bd62570cd7ff457edb8c39befc6f885cde88',
			               'nert_43aafe68a5ca510d99c9ff52abbaef913c3f6128',
			               'nert_ab41db3934c3ea775677f75059a6110d669f0ef3'],
			'Video game featuring female protagonists': ['nert_a295b8a2dc4a2fc5cba6896aa1183533d268188c',
			                                             'nert_4dd7cde665c43256e45adcb1595de2314127fe02',
			                                             'nert_3ed861762f5d5f60d336708b55340cd584457f3b'],
			'Toxin': ['nert_542d022772461bb7b9620e017a1d1544882b3648', 'nert_a3d56550ed635f26d985fc5cceb633569963bfa5',
			          'nert_036b3637ef59783bbbb5d093c91114489edef6cc'],
			'Forest': ['nert_c6935db3f3936cd271ff0f77bb021c9aef97eb71', 'nert_cfa7d88eab75543cdaa973f02015052db7ac18d0',
			           'nert_c44d014e7566e636059e268526bce60425358b9e'],
			'Entomologist': ['nert_a69ce6bd05ef120a43d2929b3ae49a068c9a104e',
			                 'nert_af8c5429cd54a1549aa87d96e35e74b35a390464',
			                 'nert_23e77b4e3083f9dd12cf03ffaa2eff5984417dbd'],
			'Organization based in Israel': ['nert_11b9992c8cfba4fa533bcdcff41ef97d0ca40eda',
			                                 'nert_8b9cf2bf329e7a7faec0d913abd5e15f197d6e85',
			                                 'nert_acbdf6cdf20b1a558431e54b1247b9a35e04cf0b'],
			'Fencer': ['nert_fc8770136eff277d9af833796f53fb9deb70bcfd', 'nert_516ac86347516d6c734059f9b47d3eb7b17dbb06',
			           'nert_0255de15622c06a85c951cab7a6146a14ecf8f14'],
			'Recipient of the Order of Lenin': ['nert_24301bc10d9e0e8a3ee2039dbabc75f67b1142c1',
			                                    'nert_50972f85b0c8aef1addc23d6fdf3ba2556a64591',
			                                    'nert_d3de129bc0f32db1de96a8be7d3908814fd0b0d8'],
			'Tunnel': ['nert_555ff39f474a89967bf19fa871ddc2a9871d9f50', 'nert_6113c1b86f36c4293b49f9bb95a82946093bd9f9',
			           'nert_693e2ec12f027ead31d7f88ed7c4d0e091c7483b'],
			'Science fiction book': ['nert_cf54d94298296e29ae1578b018c8febf7f829827',
			                         'nert_5bba31e9a90ecffd2f34da221edc308a1f3f4404',
			                         'nert_c9b32c74068a22d4a4a241fbf2e00033f1b2b648'],
			'Hindu temple': ['nert_90f948498eb612b3be3ee8fa91c9db68bd767837',
			                 'nert_85f56892116aa5fe0b81bf546d3cf3f86ced338d',
			                 'nert_48005f28e69f7984388383a9aca95b500239da6d'],
			'Animal welfare organization': ['nert_b84955182a65acabae47b4bb3cad4a1be0e16544',
			                                'nert_41b495fd670b9110a0926dd3ff69f17412f2039b',
			                                'nert_c7108893962d6b4e206d26c0e77b3c76917d2d5f'],
			'Choreographer': ['nert_6d5920184832d66f65000491b09bb210231fed98',
			                  'nert_15f3af68d0c8ff2c290431017803cfe4d87dbbcb',
			                  'nert_600f6ecb424383f16fa83d160d20bd8148a6c7d0'],
			'Soup or stew': ['nert_446b21978ec9db077a16ac163ba0fa97285e81b5',
			                 'nert_4719abc59e81e4737172329aa6e4ae2e15e270d0',
			                 'nert_398db83d73562f9c197d84ef7baff2076d5173a7'],
			'Computer scientist': ['nert_aab5b4d0e2c371a7e100d02d3a83dee79472104f',
			                       'nert_a97e97d1f59824cdeb7644e89793abcfb45f8b89',
			                       'nert_2399ce7f3f92608a20117dd55a5ddcb28a6b9030'],
			'AFL player': ['nert_1f93683b0b0678244b278ba0bf10165cb32d7ead',
			               'nert_70b870b9cbd86c6af4e15022b98c6437a9c5a9c1',
			               'nert_382b55df69f3f5d55d3ad9535802516cbd81d77b'],
			'Hip hop album': ['nert_c21fb34165443fb8394e0fec1431f0b0e5a79f21',
			                  'nert_477d5ee8f0f8900fee6932b58c57ac5a7871b5f2',
			                  'nert_e63d8d4aa802123a0143291ad99a40fdf72940ff'],
			'Baroque artist': ['nert_1224e34269d29669c432e7d08e2aaf640a22b0a7',
			                   'nert_4ef87c79ad92f4484927eee72d5f003643f2de31',
			                   'nert_d4b889be9590ea085d840c491d2e67019410d328'],
			'Card game': ['nert_ba7662df02d5be0597bf85b60811333a6e097d1a',
			              'nert_ebf7da05a3ab7a0d259df562225f7a9c23ac580c',
			              'nert_3458b5fdbdc7211124b44d64074d7da3d0ba9bca'],
			'Swimmer': ['nert_ed318ef7a0990f6147453c866fb1a490e608f37b',
			            'nert_82325565e05668cdf2fae0138314b9ac3077d320',
			            'nert_1d05168671f35b186e8ccebe96f67c69be764001'],
			'Buddhist temple': ['nert_c93dee861a8f71b549332e440e3c27208c20fbed',
			                    'nert_11e37e3b1042991f8de641f0007d6288db0c501a',
			                    'nert_3d22ecea412ee63b45d115d11ed4eb3728bba528'],
			'Sports car': ['nert_ef754676528d6355fb4f83d17ae422c80af451ed',
			               'nert_d51cb20c6481da1fef0c513cecfa1d5e892604f2',
			               'nert_308c97e5fc98972e7cd5e76a49ca63729aad94d0'],
			'Snake': ['nert_a292e0c882ccf7c8a40f9e232f586bad092f29c9', 'nert_77755f3367ae2710d17875dd7c5b71960f325e7e',
			          'nert_ed767633b7af052998dcd8d5b8e4a75cd9badd48'],
			'Ornamental tree': ['nert_9fc0623ea44cc7e9b463c0dc90ee0b8008aa59eb',
			                    'nert_e01b03989ed5d101e9257a3ca2b969718d9ba543',
			                    'nert_28505b56cbbf8c097427a79ff71c7903d800a5e9'],
			'Park in Asia': ['nert_5e0983e2040a69c54b7f8c45d0829996827f0984',
			                 'nert_6a8660e551a312bbdaedc7ac407468c07e8cb767',
			                 'nert_e03a56646969b1fa8e78e4ec6f6105e929226cdf'],
			'Bay of the Atlantic Ocean': ['nert_b236bc1f7a64df1a060459db52bc589178177ba7',
			                              'nert_27f62336d2d8d7b9ca325bb0789bd7de54c26cd1',
			                              'nert_caf1d89b1b8f57d11b854161201c33437f553d89'],
			'Mythological king': ['nert_01e69b8b02c7ce3ad41e50ad5424fcebaf9a3057',
			                      'nert_948556397c957f39ca2f2c5c1cd9ac8f22d04f03',
			                      'nert_4cf983f0c57298d1eb7f5b60b890c1d6b6b7d067'],
			'Food writer': ['nert_beeb76f0097869503c53c433094a30a3baf2e302',
			                'nert_28264ce685b46f235e39d11f17bd8bedff539d39',
			                'nert_6e652a68da46c7cf2e2a288f6e097e0d9b5affd5'],
			'Olympic boxer': ['nert_e4ff417a9ed55909f0852f39dfd22aa12b0166b3',
			                  'nert_f85f461d646f1f81ff0293760495557bf1025419',
			                  'nert_83cbd62ca14c6da23bc0f145b937751bf6aa9ae7'],
			'Italian actor': ['nert_b089a12ba47bf99eb12b2fae7a6faa45a778d61b',
			                  'nert_54060685eb106c37b1be1a1685704dc184527589',
			                  'nert_6081777dc08abf4cba47c9afffcc3e1879dcf569'],
			'Historic house': ['nert_6ecba6780a3c9a5b7f5c17e0988b104edda0493f',
			                   'nert_06988a9b03d621910f2d9390b8211a06aeb0e965',
			                   'nert_5640079aadfebf3ac405589c5fcd123ff64dd2ac'],
			'Chef': ['nert_fabd7935e9b1ad2e1e6128fc66fe624e02be1da5', 'nert_9bec4ed93204dc9a2c0e2a6f230df98fef7c80fc',
			         'nert_0ffc000518ad1dcdf9312f8d1ec50e22759ff2d1'],
			'Italian criminal': ['nert_18dd5bf1ff251ee668777e5e9c0adb16a929dbe3',
			                     'nert_48837a6f6e72083313b7f25ed617d4fbb7ad34e6',
			                     'nert_b918c02136d49d75ea36b89edd0f41670a9bda7b'],
			'Rower': ['nert_156fa4c20b0b7c413483bdbbd17964e6dedf2f6a', 'nert_e105cf6b211531953f24b391f88cdf072035d9cb',
			          'nert_f5f51f915aed781da4953c3f0ab54de1802ddc29'],
			'Company of Russia': ['nert_ade67e8a680d602bb285dd54ec7268735b87d9a7',
			                      'nert_551bbb0bea6b0031b3bbff671b00b2a60bb2030a',
			                      'nert_2a9ee9ba4fbadead1283736c988ed8707cd10af2'],
			'Mexican television actor': ['nert_bea971355ad22266570c413a301266212941621b',
			                             'nert_5dbaa46a7260817c8cb3d3f5d277fccff5aa5582',
			                             'nert_82742268c46e5754a2efade3e8bc37ad69cdc710'],
			'Poetry book': ['nert_9f87bc59576496a54463dd7e4c43583b39e90e02',
			                'nert_c8c7b6c3c3a03430b87eeff4f508522c7241cdd7',
			                'nert_69a451c8d599614f5f5ff92427ea19222a3f7270'],
			'Russian painter': ['nert_44b3cc97b0c5afb849ac09de6d4d8a483b8bfa4a',
			                    'nert_df279781a7b001c105992407b046c4906c6d5772',
			                    'nert_5ea14fc142c85ac79f99e282cb32cb52f8b692f7'],
			'Swedish song': ['nert_d5e3707a025b1d1953ad26e0113caebee37edeed',
			                 'nert_ef6866904b019c60df6631b88ff56fb0b891ad33',
			                 'nert_91f622f4cd5f3ef28ba317d4b6a27ad36e4abd03'],
			'Destroyer': ['nert_f1bd3c4805391e5977d09a571733fe83ecfc60fb',
			              'nert_79666819ae40449c8ee7da12319e640f379e5835',
			              'nert_64fe3da22d77e3a77778d2328901422e715515ba'],
			'American mobster': ['nert_2865a1478d6709d0d9596eb1910d7e9f3404bec4',
			                     'nert_6b4125917edf9b9d724aa8d4736425f5c11dc769',
			                     'nert_31a9a01ffc0ceefc57a203dffd30cd83a0a6850e'],
			'British economist': ['nert_4514513b46a9b027aea0d6aabab12a953c80afbc',
			                      'nert_83d7b4f793090a965f811afa8f79eb305e30682c',
			                      'nert_ccb1535886c0257ef3cca3bd8ac60e1da53d51b2'],
			'Fungal disease': ['nert_68c6692f44cd339842c3f6b0e81a2c5d01c7dfea',
			                   'nert_4975bc0a5938127d8958cf7f4162d7b93134bc3d',
			                   'nert_d833a22fd014239bf173dc8906e466775044ff4a'],
			'Sculpture of people': ['nert_4ab7265eeda00bf2f449982b9b0d0c2879680457',
			                        'nert_44e2d20641767c162f10bd8e61194578afee9228',
			                        'nert_b2ee8564c15b43ed4fea1f1851ddb0f76af06e84'],
			'Agriculture minister': ['nert_fb7fe7d474b9e3fb68384db6e126b48ebbe3a335',
			                         'nert_62facd7cafd81f295a79b3f92f0f99cbb31b0798',
			                         'nert_f3d0702ccefddda07475607cd67e9873965547cc'],
			'Shipbuilding company': ['nert_f82979d7b4b596d58df28cf53f850196045ada22',
			                         'nert_90778c66e381a9da698143b37b1e7f0570618b80',
			                         'nert_a4fa3c28446cd0ffd5d84a2cba40ba9a60d3ef63'],
			'Orchid': ['nert_4bfe4942a4884b1588958df09f4867736f67ea2e', 'nert_ba27fe284a2b40ad8d33659eb50dbcf239a985fe',
			           'nert_217eeb6dda1c2a3ae717ee211ab3728d9cf11463'],
			'Danish film': ['nert_3e23f44bd2b7d9879f05cfa6af9fcd4e0385f86a',
			                'nert_b939164a37867bbcf035e2a839e5b607148bc57c',
			                'nert_0a77c8c5ca7ffe6e1da420a39f91a9269364fedc'],
			'Noctuid genera': ['nert_00c1e060f002800bac1e5a1b25203498c626c72b',
			                   'nert_fc3eb681fc4d43e0cabcc695818ea4052ff08c28',
			                   'nert_0514e619c4eda16901ed58121bc7499efced49b5'],
			'Highway in India': ['nert_47131aa3f91f574ba0863c2773195fa0a1d4183b',
			                     'nert_c346bac42f95ec2de877e9c2dc179fbb0c6c5675',
			                     'nert_89b376c9064ff9d225af0e7eba71cffb73c9fddd'],
			'Coal mine': ['nert_facb7540e315b8ec70dd15bb47a7b53484d217ad',
			              'nert_255f2778a7bde338279d97b3e266e95f39c22395',
			              'nert_2b68a9bffbaf419953f188ec64cbf1c370b61088'],
			'Shinto shrine': ['nert_c6d0f52a1d659063ca1d2071660d585e9ffebf6c',
			                  'nert_080424d2d3a8929af54c2556f798464662d70a86',
			                  'nert_acf6c9ebe031a7e774b7a700aaa5f62df4941bd5'],
			'Israeli Basketball Premier League player': ['nert_3612697fd813a8b0d5caac8ee8a81aa6f4fe1c4b',
			                                             'nert_37f30fc071ab03752755f9c38054a8b07f70bff4',
			                                             'nert_1803c9717e33bd90561b922f54842424dee2da76'],
			'Belgian politician': ['nert_10a642d6d2b23399e01b7b2d5f1945985747242c',
			                       'nert_dbe6aa569c956aa62e97b3ad054fdf9b50ac2e02',
			                       'nert_58fbc1d25fe991e317d365f9a800d92980314d00'],
			'Rabbi in North America': ['nert_0df7efa408d280abe13ac403ca81cc7018705892',
			                           'nert_345463da4e5c06afd87a89c78101efb4fd8b4792',
			                           'nert_c978dc48c69d72bab89f5be953112e9ab40c0242'],
			'Zoo in Europe': ['nert_318275ab753f8bcf0992565f4b495bd53b9b4d39',
			                  'nert_63a56211e98c5de6b28349e8b0fafe464ddbbb55',
			                  'nert_2796d5b989edd1e513526680b98841740f5e4887'],
			'Male racewalker': ['nert_5745b8a8a2eb0b0edc1d948e21cd1e41342fac45',
			                    'nert_9e4bd261de2f6806fc53b753b8389f8a204abe28',
			                    'nert_4529d2a55cf29c7e820142d902382241917a4775']
		}


if __name__ == '__main__':
	clearml_poc.clearml_init(task_name='eval nertrieve', queue_name='dsicsgpu')

	layer_obj = {
		"layer_id": "7b24211634fd454e99d34b65286ab4d7",
		"llm_layer": FineTuneLLM.layer,
		"llm_id": FineTuneLLM.llm_id
	}
	clearml_poc.clearml_connect_hyperparams(name='eval nertrieve', hyperparams=layer_obj)
	llm_layer = layer_obj["llm_layer"]
	llm_id = layer_obj["llm_id"]
	args = clearml_helper.get_args_by_mlp_id(layer_obj['layer_id'])
	entity_type_to_embedding = fewnerd_processor.load_entity_name_embeddings(
		layer_name=fewnerd_dataset.llm_and_layer_to_elastic_name(
			llm_id=llm_id,
			layer=llm_layer
		),
		index='nertrieve_entity_name_to_embedding',
		entity_name_strategy='avg'
	)
	layer = layer_obj['layer_id']
	mlp = clearml_helper.get_mlp_by_id(layer)
	mlp = mlp.double()

	import torch

	type_to_name = nertrieve_processor.type_to_name()
	entity_type_to_embedding = {
		type_to_name[key]:mlp(value).tolist()
	    # type_to_name[key]:value.tolist()

		for key, value in entity_type_to_embedding.items()
	}

	layer = layer_obj["layer_id"]
	llm_layer = layer_obj["llm_layer"]
	llm_id = layer_obj["llm_id"]
	nertrieve = NERtrieveEvalZeroShot(layer=layer, entity_to_embedding=entity_type_to_embedding)
	nertrieve.eval_one_shot()
	nertrieve.eval_zero_shot()

